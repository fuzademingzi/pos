#:import hex kivy.utils.get_color_from_hex
<Label>:
    font_name: "SimHei"

<Title>:
    font_name: "SimHei"

<TextInput>:
    font_name: "SimHei"

<Button>:
    font_name: "SimHei"

<BotonOscuro@Button>:
	background_normal: ''
	background_color: hex('#393939')

<LabelOscuro@Label>:
	canvas.before:
		Color:
			rgba: hex('#393939')
		Rectangle:
			size: self.size
			pos: self.pos


<AdminRV>:
    SelectableRecycleBoxLayout:
        default_size: None, dp(36)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: 'vertical'
        multiselect: False
        touch_multiselect: False

<SelectableProductoLabel>:
    # Draw a background to indicate selection
    canvas.before:
        Color:
            rgba: hex('#C9F3EF') if self.selected else hex('#F0F0F0')
        Rectangle:
            pos: self.pos
            size: self.size
    Label:
    	id: _hashtag
    	size_hint_x: .05
    	color: (0,0,0,1)
    Label:
    	id: _codigo
    	size_hint_x: .35
    	color: (0,0,0,1)
    Label:
    	id: _articulo
    	size_hint_x: .35
    	color: (0,0,0,1)
    Label:
    	id: _cantidad
    	size_hint_x: .125
    	color: (0,0,0,1)
    Label:
    	id: _precio
    	size_hint_x: .125
    	color: (0,0,0,1)

<SelectableClienteLabel>:
    # Draw a background to indicate selection
    canvas.before:
        Color:
            rgba: hex('#C9F3EF') if self.selected else hex('#F0F0F0')
        Rectangle:
            pos: self.pos
            size: self.size
    Label:
        id: _hashtag
        size_hint_x: .02
        color: (0,0,0,1)
    Label:
        id: _client
        size_hint_x: .05
        color: (0,0,0,1)
    Label:
        id: _name
        size_hint_x: .05
        color: (0,0,0,1)
    Label:
        id: _tel_number
        size_hint_x: .08
        color: (0,0,0,1)
    Label:
        id: _email
        size_hint_x: .15
        color: (0,0,0,1)
    Label:
        id: _address
        size_hint_x: .15
        color: (0,0,0,1)
    Label:
        id: _city
        size_hint_x: .05
        color: (0,0,0,1)
    Label:
        id: _birth_date
        size_hint_x: .10
        color: (0,0,0,1)
    Label:
        id: _observations
        size_hint_x: .10
        color: (0,0,0,1)

<SelectableUsuarioLabel>:
    # Draw a background to indicate selection
    canvas.before:
        Color:
            rgba: hex('#C9F3EF') if self.selected else hex('#F0F0F0')
        Rectangle:
            pos: self.pos
            size: self.size
    Label:
    	id: _hashtag
    	size_hint_x: .05
    	color: (0,0,0,1)
    Label:
    	id: _nombre
    	size_hint_x: .35
    	color: (0,0,0,1)
    Label:
    	id: _username
    	size_hint_x: .35
    	color: (0,0,0,1)
    Label:
    	id: _tipo
    	size_hint_x: .25
    	color: (0,0,0,1)

<SelectableVentaLabel>:
	canvas.before:
        Color:
            rgba: hex('#C9F3EF') if self.selected else hex('#F0F0F0')
        Rectangle:
            size: self.size
            pos: self.pos
    Label:
        id: _hashtag
        size_hint_x: .05
        color: (0,0,0,1)
    Label:
        id: _username
        size_hint_x: .15
        color: (0,0,0,1)
    Label:
        id: _client
        size_hint_x: .15
        color: (0,0,0,1)
    Label:
        id: _cantidad
        size_hint_x: .1
        color: (0,0,0,1)
    Label:
        id: _total
        size_hint_x: .15
        color: (0,0,0,1)
    Label:
        id: _time
        size_hint_x: .2
        color: (0,0,0,1)
    Label:
        id: _date
        size_hint_x: .2
        color: (0,0,0,1)

<ItemVentaLabel>:
    canvas.before:
        Color:
            rgba: hex('#F0F0F0')
        Rectangle:
            size: self.size
            pos: self.pos
    Label:
        id: _hashtag
        size_hint_x: .05
        color: (0,0,0,1)
    Label:
        id: _codigo
        size_hint_x: .25
        color: (0,0,0,1)
    Label:
        id: _articulo
        size_hint_x: .25
        color: (0,0,0,1)
    Label:
        id: _cantidad
        size_hint_x: .15
        color: (0,0,0,1)
    Label:
        id: _precio_por_articulo
        size_hint_x: .15
        color: (0,0,0,1)
    Label:
        id: _total
        size_hint_x: .15
        color: (0,0,0,1)

<ProductoPopup>:
    size_hint: .5, .5
    auto_dismiss: False
    title: ''
    BoxLayout:
	    orientation: 'vertical'
	    padding: .05
	    BoxLayout:
	    	size_hint_y: .1
		    Label:
		    	id: producto_info_1
	    Label:
	    	id: no_valid_notif
	    	size_hint_y: .1
	    TextInput: 
			size_hint_y: .2
			id: producto_codigo
			multiline: False
			hint_text: '编号'
			write_tab: False
		TextInput: 
			id: producto_nombre
			size_hint_y: .2
			multiline: False
			hint_text: '商品名'
			write_tab: False
		BoxLayout:
			size_hint_y: .2
			TextInput: 
				id: producto_cantidad
				multiline: False
				hint_text: '数量'
				write_tab: False
			TextInput: 
				id: producto_precio
				multiline: False
				hint_text: '单价'
				write_tab: False
		BoxLayout:
			size_hint_y: .2
		    Button:
		    	text: '确认'
		    	on_release: root.verificar(producto_codigo.text, producto_nombre.text, producto_cantidad.text, producto_precio.text)
		    Button:
		        text: '放弃更改并退出'
		        on_press: root.dismiss()

<UsuarioPopup>:
    size_hint: .5, .5
    auto_dismiss: False
    title: ''
    BoxLayout:
	    orientation: 'vertical'
	    padding: .05
	    Label:
	    	size_hint_y: .1
	    	id: usuario_info_1
	    Label:
	    	id: no_valid_notif
	    	size_hint_y: .1
	    TextInput: 
			size_hint_y: .2
			id: usuario_username
			multiline: False
			hint_text: '用户名'
			write_tab: False
		TextInput: 
			id: usuario_nombre
			size_hint_y: .2
			multiline: False
			hint_text: '姓名'
			write_tab: False
		BoxLayout:
			size_hint_y: .2
			TextInput:
				size_hint_x: .5
				id: usuario_password
				multiline: False
				hint_text: '密码'
				password: True
				write_tab: False
			ToggleButton: 
				size_hint_x: .25
				id: admin_tipo
				text: '管理员'
				group: 'usuario_tipo'
			ToggleButton: 
				size_hint_x: .25
				id: trabajador_tipo
				text: '员工'
				group: 'usuario_tipo'
		BoxLayout:
			size_hint_y: .2
		    Button:
		    	text: '确认'
		    	on_release: root.verificar(usuario_username.text, usuario_nombre.text, usuario_password.text, admin_tipo.state, trabajador_tipo.state)
		    Button:
		        text: '放弃更改并退出'
		        on_press: root.dismiss()

<VistaProductos>:
	name: 'Productos'
	BoxLayout:
		BoxLayout:
			padding: .5
			orientation: 'vertical'
			BoxLayout:
				size_hint_y: .05
				spacing: .5
				LabelOscuro:
					text: '#'
					size_hint_x: .05
				LabelOscuro:
					text: '商品编号'
					size_hint_x: .35
				LabelOscuro:
					text: '编号'
					size_hint_x: .35
				LabelOscuro:
					text: '数量'
					size_hint_x: .125
				LabelOscuro:
					text: '价格'
					size_hint_x: .125
			AdminRV:
				id: rv_productos
				size_hint_y: .89
				viewclass: 'SelectableProductoLabel'
		BoxLayout:
			spacing: .5
			size_hint_x: .2
			orientation: 'vertical'
			padding: .5
			BotonOscuro:
				text: '添加商品'
				on_release: root.agregar_producto()
			BotonOscuro:
				text: '修改商品'
				on_release: root.modificar_producto()
			BotonOscuro:
				text: '删除商品'
				on_release: root.eliminar_producto()


<VistaUsuarios>:
	name: 'Usuarios'
	BoxLayout:
		BoxLayout:
			padding: .5
			orientation: 'vertical'
			BoxLayout:
				size_hint_y: .05
				spacing: .5
				LabelOscuro:
					text: '#'
					size_hint_x: .05
				LabelOscuro:
					text: '姓名'
					size_hint_x: .35
				LabelOscuro:
					text: '用户名'
					size_hint_x: .35
				LabelOscuro:
					text: '类型'
					size_hint_x: .25
			AdminRV:
				id: rv_usuarios
				size_hint_y: .89
				viewclass: 'SelectableUsuarioLabel'
		BoxLayout:
			spacing: .5
			size_hint_x: .2
			orientation: 'vertical'
			padding: .5
			BotonOscuro:
				text: '添加用户'
				on_release: root.agregar_usuario()
			BotonOscuro:
				text: '修改用户'
				on_release: root.modificar_usuario()
			BotonOscuro:
				text: '删除用户'
				on_release: root.eliminar_usuario()

<InfoVentaPopup>:
    size_hint: .5, .5
    title: 'Detail:'
    font_name: 'SimHei'
    BoxLayout:
    	orientation: 'vertical'
	    padding: .05
	    BoxLayout:
    		size_hint_y: .1
	    	LabelOscuro:
	    		text: '#'
	    		size_hint_x: .05
	    	LabelOscuro:
	    		text: '编号'
	    		size_hint_x: .25
	    	LabelOscuro:
	    		text: '名称'
	    		size_hint_x: .25
	    	LabelOscuro:
	    		text: '数量'
	    		size_hint_x: .15
	    	LabelOscuro:
	    		text: '单价'
	    		size_hint_x: .15
	    	LabelOscuro:
	    		text: '总价'
	    		size_hint_x: .15
	    AdminRV:
			id: info_rv
		    viewclass: 'ItemVentaLabel'
		BoxLayout:
    		size_hint_y: .1
			LabelOscuro:
				text: '已售商品:'
	    		size_hint_x: .25
			LabelOscuro:
				id: total_items
	    		size_hint_x: .25
			LabelOscuro:
				text: '总售出: '
	    		size_hint_x: .25
			LabelOscuro:
				id: total_dinero
	    		size_hint_x: .25


<VistaVentas>:
	name: 'Ventas'
	BoxLayout:
		orientation: 'vertical'
		BoxLayout:
			size_hint_y: .1
			spacing: .5
			padding: .5
			LabelOscuro:
				id: notificacion
				text: '销售数据'
				size_hint_x: .35
			LabelOscuro:
				text: '正在浏览: '
				size_hint_x: .15
			LabelOscuro:
				id: date_id
				size_hint_x: .2
				text: '今日'
			LabelOscuro:
				text: '全部: '
				size_hint_x: .1
			LabelOscuro:
				id: final_sum
				size_hint_x: .2
		BoxLayout:
			size_hint_y: .1
			spacing: .5
			padding: .5
			LabelOscuro:
				text: '#'
				size_hint_x: .05
			LabelOscuro:
				text: '员工名'
				size_hint_x: .15
			LabelOscuro:
				text: '客户编号'
				size_hint_x: .15
			LabelOscuro:
				text: '件数'
				size_hint_x: .1
			LabelOscuro:
				text: '总计'
				size_hint_x: .15
			LabelOscuro:
				text: '时间'
				size_hint_x: .2
			LabelOscuro:
				text: '日期'
				size_hint_x: .2
		AdminRV:
			id: ventas_rv
			viewclass: 'SelectableVentaLabel'
		BoxLayout:
			size_hint_y: .07
			spacing: .5
			padding: .5
			LabelOscuro:
				text: '特定日期:'
			TextInput:
				id: single_date
				multiline: False
				hint_text: '0000-00-00'
				write_tab: False
				on_text_validate: root.cargar_venta('Date')
			LabelOscuro:
				text: '日期范围:'
			TextInput:
				id: initial_date
				multiline: False
				hint_text: '1970-01-01'
				write_tab: False
				on_text_validate: root.cargar_venta('Range')
			LabelOscuro:
				text: '-'
				size_hint_x: .06
			TextInput:
				id: last_date
				multiline: False
				hint_text: '2099-12-31'
				write_tab: False
				on_text_validate: root.cargar_venta('Range')
			BotonOscuro:
				text: '昨日'
				on_release: root.cargar_venta('Yesterday')
			BotonOscuro:
				text: '今日'
				on_release: root.cargar_venta('Default')
			BotonOscuro:
				text: '详细信息'
				on_release: root.mas_info()
			BotonOscuro:
				text: '导出为表格'
				on_release: root.crear_csv()
<VistaClientes>:
    name: 'Clientes'
    BoxLayout:
        BoxLayout:
            padding: .5
            orientation: 'vertical'
            BoxLayout:
                size_hint_y: .05
                spacing: .5
                LabelOscuro:
                    text: '#'
                    size_hint_x: .02
                LabelOscuro:
                    text: '客户ID'
                    size_hint_x: .05
                LabelOscuro:
                    text: '姓名'
                    size_hint_x: .05
                LabelOscuro:
                    text: '电话'
                    size_hint_x: .08
                LabelOscuro:
                    text: '邮箱'
                    size_hint_x: .15
                LabelOscuro:
                    text: '地址'
                    size_hint_x: .15
                LabelOscuro:
                    text: '邮编'
                    size_hint_x: .05
                LabelOscuro:
                    text: '出生日期'
                    size_hint_x: .10
                LabelOscuro:
                    text: '备注'
                    size_hint_x: .10
            AdminRV:
                id: rv_clientes
                size_hint_y: .89
                viewclass: 'SelectableClienteLabel'
        BoxLayout:
            spacing: .5
            size_hint_x: .2
            orientation: 'vertical'
            padding: .5
            BotonOscuro:
                text: '添加客户'
                on_release: root.agregar_cliente()
            BotonOscuro:
                text: '修改客户'
                on_release: root.modificar_cliente()
            BotonOscuro:
                text: '删除客户'
                on_release: root.eliminar_cliente()

<ClientePopup>:
    size_hint: .5, .5
    auto_dismiss: False
    title: ''
    BoxLayout:
        orientation: 'vertical'
        padding: .05
        BoxLayout:
            size_hint_y: .1
            Label:
                id: cliente_info_1
        Label:
            id: no_valid_notif
            size_hint_y: .1
        TextInput:
            size_hint_y: .1
            id: cliente_id
            multiline: False
            hint_text: '客户ID'
            write_tab: False
        TextInput:
            size_hint_y: .1
            id: cliente_nombre
            multiline: False
            hint_text: '姓名'
            write_tab: False
        TextInput:
            size_hint_y: .1
            id: cliente_telefono
            multiline: False
            hint_text: '电话'
            write_tab: False
        TextInput:
            size_hint_y: .1
            id: cliente_email
            multiline: False
            hint_text: '邮箱'
            write_tab: False
        TextInput:
            size_hint_y: .1
            id: cliente_direccion
            multiline: False
            hint_text: '地址'
            write_tab: False
        TextInput:
            size_hint_y: .1
            id: cliente_ciudad
            multiline: False
            hint_text: '邮编'
            write_tab: False
        TextInput:
            size_hint_y: .1
            id: cliente_fecha_nacimiento
            multiline: False
            hint_text: '出生日期'
            write_tab: False
        TextInput:
            size_hint_y: .1
            id: cliente_observaciones
            multiline: False
            hint_text: '备注'
            write_tab: False
        BoxLayout:
            size_hint_y: .2
            Button:
                text: '确认'
                on_release:
                    root.verificar(cliente_id.text, cliente_nombre.text, cliente_telefono.text,
                    cliente_email.text, cliente_direccion.text, cliente_ciudad.text,
                    cliente_fecha_nacimiento.text, cliente_observaciones.text)
            Button:
                text: '放弃更改并退出'
                on_press: root.dismiss()

<CustomDropDown>:
	canvas.before:
		Color:
			rgba: hex('#393939')
		Rectangle:
			size: self.size
			pos: self.pos
    Button:
        text: '商品管理'
        size_hint_y: None
        height: 44
        on_release: root.vista(self.text)
    Button:
        text: '用户管理'
        size_hint_y: None
        height: 44
        on_release: root.vista(self.text)
    Button:
        text: '销售记录'
        size_hint_y: None
        height: 44
        on_release: root.vista(self.text)
    Button:
        text: '客户管理'
        size_hint_y: None
        height: 44
        on_release: root.vista(self.text)


<AdminWindow>:
	id: main_win
	orientation: 'vertical'
	canvas.before:
		Color:
			rgba: hex('#159F9A')
		Rectangle:
			size: self.size
			pos: self.pos

	BoxLayout:
		orientation: 'vertical'
		size_hint_y: .1
		BoxLayout:
			padding: .1
			spacing: .2
			BotonOscuro:
				id: cambiar_vista
				size_hint_x: .2
				text: '切换视图'
				on_release: root.cambiar_vista()
			Label:
				id: mostrat_usuario
				size_hint_x: .2
				color: hex('#000000')
			Label:
				size_hint_x: .2
			Label:
				id: notification
				size_hint_x: .2
			BotonOscuro:
				id: boton_venta
				size_hint_x: .2
				text: '前往收银'
				on_release: root.venta()
			BotonOscuro:
				id: boton_signout
				size_hint_x: .2
				text: '退出登录'
				on_release: root.signout()

	ScreenManager:
        id: vista_manager
		canvas.before:
			Color:
				rgba: hex('#FFFFFF')
			Rectangle:
				size: self.size
				pos: self.pos
		VistaProductos:	
			id: vista_productos
		VistaClientes:
			id: vista_clientes
		VistaUsuarios:
			id: vista_usuarios
		VistaVentas:
			id: vista_ventas

    BoxLayout:
    	size_hint_y:.05